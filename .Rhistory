fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.6)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.6)
#add ordinal variables
dordi<-c(28,29)
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.6)
#colors<-c("blue","red","green","orange","darkgreen")
#alternative
colors<-rainbow(length(dcat))
colors<-c("blue","red","darkgreen","orange")
#use the scale factor or not depending on the position of centroids
# ES UN FACTOR D'ESCALA PER DIBUIXAR LES FLETXES MES VISIBLES EN EL GRAFIC
fm = round(max(abs(Psi[,1])))
fm=20
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1), ylim=c(-3,1))
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
#adf_wk_i centroids
c<-1
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1), ylim=c(-1,1))
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.6)
c<-c+1
}
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1))
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.6)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.6)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map - PC1 vs PC2")
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Quantitative Variables)")
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.6)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.6)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=1)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.8)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.6)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.8)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.8)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X,Y,labels=etiq,col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.8)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.8)
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.8)
#add ordinal variables
dordi<-c(28,29)
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.6)
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.8)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.8)
#add ordinal variables
dordi<-c(28,29)
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
# lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
colors<-c("blue","red","darkgreen","orange")
colors<-c("blue","red","darkgreen","orange")
#use the scale factor or not depending on the position of centroids
# ES UN FACTOR D'ESCALA PER DIBUIXAR LES FLETXES MES VISIBLES EN EL GRAFIC
fm = round(max(abs(Psi[,1])))
fm=20
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#adf_wk_i centroids
c<-1
for(k in dcat){
seguentColor<-colors[c]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
#points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
text(fdic1,fdic2,labels=levels(factor(df_wk_i[,k])),col=seguentColor, cex=0.8)
c<-c+1
}
legend("bottomleft",names(df_wk_i)[dcat],pch=1,col=colors, cex=0.8)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
# lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,10), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.6)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.8)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.8)
c<-c+1
col<-col+1
}
legend("topleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Qualitative Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.8)
c<-c+1
col<-col+1
}
legend("bottomleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
#represent numerical variables in background
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(-1,1.2), ylim=c(-1,1), xlab = paste("PC", eje1), ylab = paste("PC", eje2), main = "Factorial Map (Ordinal Variables)")
#plot(X,Y,type="none",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
#adf_wk_i projections of numerical variables in background
arrows(ze, ze, X, Y, length = 0.07,col="lightgray")
text(X[1:8],Y[1:8],labels=etiq[1:8],col="gray", cex=0.7)
text(X[9:10],Y[9:10],labels=etiq[9:10],col="gray", cex=0.7, pos=3)
text(X[11],Y[11],labels=etiq[11],col="gray", cex=0.7, pos=1)
text(X[12],Y[12],labels=etiq[12],col="gray", cex=0.7, pos=3)
#add ordinal variables
dordi<-c(28,29)
colors<-c("green","purple")
c<-1
col<-1
for(k in dordi){
seguentColor<-colors[col]
fdic1 = tapply(Psi[,eje1],df_wk_i[,k],mean)
fdic2 = tapply(Psi[,eje2],df_wk_i[,k],mean)
# points(fdic1,fdic2,pch=16,col=seguentColor, labels=levels(df_wk_i[,k]))
#connect modalities of qualitative variables
lines(fdic1,fdic2,pch=16,col=seguentColor)
text(fdic1,fdic2,labels=levels(df_wk_i[,k]),col=seguentColor, cex=0.8)
c<-c+1
col<-col+1
}
legend("bottomleft",names(df_wk_i)[dordi],pch=1,col=colors[1:length(dordi)], cex=0.8)
